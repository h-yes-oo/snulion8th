<!-- index.html -->
{% extends 'base.html' %}
{% block content %}

    <h1>FEED PAGE</h1>
    {% if user.is_authenticated %}
        <a href = "/feeds/new"> NEW FEED </a>
    {% endif %} 
    {% for feed in feeds %}
        <div style="border: 1px solid grey;">
            <a href="/feeds/{{ feed.id }}/like">{{ feed.like_users.count }} Likes</a>
            <a href="/feeds/{{ feed.id }}">More</a>
            {% if request.user == feed.author %}                               
              <a href = "/feeds/{{feed.id}}/delete" onclick="return confirm('정말 삭제하시겠습니까?')">Delete Feed</a>
            {% endif %}     
            <p>{{ feed.title }}</p>
            <p>{{ feed.content }}</p>
            <p>작성자:<strong>{{feed.author.username}}</strong>
              (following: {{ feed.author.profile.follow_to.all.count }} / follower: {{ feed.author.profile.follow_from.all.count }})
              {% if user.is_authenticated %}
                {% if request.user != feed.author %}
                 <a href="/accounts/{{ feed.author.id }}/follow">
                  {% if request.user.profile not in feed.author.profile.follows.all %}
                      팔로우
                   {% else %}
                      팔로우 취소
                  {% endif %}
                 </a>
               {% endif %}
              {% endif %}
            </p>  
        </div>
      {% for c in feed.feedcomment_set.all %}
      <p>{{ c.content }}</p>
      {% if request.user == c.author %}
      <form action="/feeds/{{ feed.id }}/comments/{{ c.id }}/" method="POST">
        {% csrf_token %}
        <button>Delete comment</button>
      </form>
      {% endif %} 
    {% endfor %}
    <form action="/feeds/{{ feed.id }}/comments/" method="POST">
      {% csrf_token %}
      <input type="text" name="content" />
      <button type="submit">Add comment</button>
    </form>
    {% endfor %}
    {% endblock content %}
 <!-- for를 end시킨다는 뜻! 여기서는 들여쓰기로 끝을 못 내니 -->
</body>
</html>


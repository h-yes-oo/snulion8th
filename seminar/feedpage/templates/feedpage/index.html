{% extends 'base.html' %}
{% block content %}
      <h1>feed page</h1>
      {% if user.is_authenticated %} 
        <a href="/feeds/new">new feed</a>
      {% endif %} 
      {% for feed in feeds %} 
        <div style="border: 2px solid pink; padding: 20px;">
          <a href="/feeds/{{ feed.id }}/like">{{ feed.like_users.count }} Likes</a>
          <a href="/feeds/{{ feed.id }}">더보기</a>
          {% if request.user == feed.author %} 
            <a href="/feeds/{{ feed.id }}/delete" onclick="return confirm('정말 삭제하시겠습니까?')">삭제</a>
          {% endif %}  
          <p style="font-weight: bold;">{{ feed.title }}</p>
          <p style="font-size: 15px;">{{ feed.content }}</p>
          <p>작성자:<strong>{{feed.author.username}}</strong>
            (following: {{ feed.author.profile.follow_to.all.count }} / follower: {{ feed.author.profile.follow_from.all.count }})
            {% if user.is_authenticated %}
              {% if request.user != feed.author %}
                <a href="/accounts/{{ feed.author.id }}/follow">
                  {% if request.user.profile not in feed.author.profile.follows.all %}
                      팔로우
                  {% else %}
                      팔로우 취소
                  {% endif %}
                </a>
              {% endif %}
            {% endif %}
          </p>
          <br> !아래는 댓글임! <br>
          {% for comment in feed.feedcomment_set.all %}
            <p>{{ comment.content }}</p>
            {% if user.is_authenticated %}
              <a href="/feeds/{{ feed.id }}/comments/{{comment.id}}/like/">
                {{ comment.like_users.count }} 좋아요
              </a>
            {% endif %}  
            {% if request.user == comment.author %} 
              <form action="/feeds/{{ feed.id }}/comments/{{ comment.id }}/" method="POST">
                {% csrf_token %}
                <button>댓글 삭제</button>
              </form>
            {% endif %}   
          {% endfor %}
          {% if user.is_authenticated %} 
            <form action="/feeds/{{ feed.id }}/comments/" method="POST">
              {% csrf_token %}
              <input type="text" name="content" />
              <button type="submit">댓글 달기</button>
            </form>
          {% endif %}  
        </div>
      {% endfor %} <!-- for를 end시킨다는 뜻! 여기서는 들여쓰기로 끝을 못 내니 -->
{% endblock content %}